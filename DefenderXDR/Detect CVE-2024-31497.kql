// Detect CVE-2024-31497
//  https://www.linkedin.com/posts/activity-7185927077483708416-qNtB/

// To check if you have a 521-bit ECDSA key in PuTTY, you can use the following command in the PuTTY terminal (Look for ecdsa-sha2-nistp521)
// ssh-keygen -l -f ~/.ssh/id_ecdsa

// KQL to check for impacted putty installation.

DeviceTvmSoftwareInventory
| where SoftwareName contains "putty"
| where SoftwareVersion contains "0.68" or SoftwareVersion contains "0.69" or SoftwareVersion contains "0.70" or SoftwareVersion contains "0.71" or SoftwareVersion contains "0.72" or SoftwareVersion contains "0.73" or SoftwareVersion contains "0.74" or SoftwareVersion contains "0.75" or 
SoftwareVersion contains "0.76" or SoftwareVersion contains "0.77" or SoftwareVersion contains "0.78" or SoftwareVersion contains "0.79" or SoftwareVersion contains "0.80"

// MITRE ATT&CK Mapping
// The detection of specific software versions, especially those known to have vulnerabilities, can be associated with several MITRE ATT&CK techniques. Here are some relevant techniques:

// T1082 - System Information Discovery: Adversaries may attempt to get a listing of software installed on a system to identify potential vulnerabilities1.

// T1518.001 - Software Discovery: This technique involves adversaries querying the software installed on a system to find vulnerabilities they can exploit2.

// T1070.004 - File Deletion: If an adversary identifies vulnerable software, they might attempt to delete logs or other files to cover their tracks3.
