// Detect CVE-2024-31497
//  https://www.linkedin.com/posts/activity-7185927077483708416-qNtB/

// To check if you have a 521-bit ECDSA key in PuTTY, you can use the following command in the PuTTY terminal (Look for ecdsa-sha2-nistp521)
// ssh-keygen -l -f ~/.ssh/id_ecdsa

// KQL to check for impacted putty installation.

DeviceTvmSoftwareInventory
| where SoftwareName contains "putty"
| where SoftwareVersion contains "0.68" or SoftwareVersion contains "0.69" or SoftwareVersion contains "0.70" or SoftwareVersion contains "0.71" or SoftwareVersion contains "0.72" or SoftwareVersion contains "0.73" or SoftwareVersion contains "0.74" or SoftwareVersion contains "0.75" or 
SoftwareVersion contains "0.76" or SoftwareVersion contains "0.77" or SoftwareVersion contains "0.78" or SoftwareVersion contains "0.79" or SoftwareVersion contains "0.80"
