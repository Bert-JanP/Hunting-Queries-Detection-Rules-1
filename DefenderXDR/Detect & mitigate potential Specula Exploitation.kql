// Detect & mitigate potential Specula Exploitation
// https://www.linkedin.com/posts/activity-7223926720356044800-fxX2/

Custom NRT DefenderXDR detection & isolation of endpoint to prevent exploitation of red team post-exploitation framework (Specula)

DeviceRegistryEvents
| where RegistryKey contains "\\Software\\Microsoft\\Office" and RegistryKey contains "\\Outlook\\webview"
| where RegistryValueName contains "URL"
| where RegistryValueData contains "http://" or RegistryValueData contains "https://"

// MITRE ATT&CK Mapping

// This query can be associated with the following MITRE ATT&CK techniques:

// T1112 - Modify Registry:
// The query detects changes to the registry, which is a common technique used by adversaries to maintain persistence or execute malicious code1.

// T1071.001 - Application Layer Protocol: Web Protocols:
// By looking for URLs in registry values, the query can help identify the use of web protocols for command and control or data exfiltration2.

// T1137.001 - Office Application Startup: Outlook:
// The focus on Outlookâ€™s webview settings suggests a potential technique where adversaries manipulate Office application settings to execute malicious code or scripts3.
