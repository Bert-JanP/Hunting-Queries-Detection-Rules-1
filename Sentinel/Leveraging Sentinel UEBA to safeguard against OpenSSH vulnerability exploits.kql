// Leveraging Sentinel UEBA to safeguard against OpenSSH vulnerability exploits 
// https://www.linkedin.com/posts/activity-7217745435635900416-ZIa7/

// Using Sentinel UEBA threat intelligence data, you can identify the IP addresses of SSH BruteForce attackers targeting your cloud or on-premises environment. By adding these IPs to your firewall block list, you can enhance protection against OpenSSH vulnerability exploits, specifically CVE-2024-6387 (hashtag#RegreSSHion) and CVE-2024-6409 (hashtag#Privsep).

BehaviorAnalytics
| where TimeGenerated > ago(90d)
| extend ThreatIntelIndicatorDescription = DevicesInsights.ThreatIntelIndicatorDescription
| where isnotempty( ThreatIntelIndicatorDescription ) 
| where ThreatIntelIndicatorDescription contains "destination_port_numbers: 22" and 
ThreatIntelIndicatorDescription contains "A BruteForce indicator"
| distinct SourceIPAddress, SourceIPLocation
| sort by SourceIPLocation asc
